<!DOCTYPE html>
<!--

  .---.    .-./`)  ________     .-''-.          .-./`)    .-'''-.            .-'''-. .---.  .---.     ,-----.    .-------. ,---------.  
  | ,_|    \ .-.')|        |  .'_ _   \         \ .-.')  / _     \          / _     \|   |  |_ _|   .'  .-,  '.  |  _ _   \\          \ 
,-./  )    / `-' \|   .----' / ( ` )   '        / `-' \ (`' )/`--'         (`' )/`--'|   |  ( ' )  / ,-.|  \ _ \ | ( ' )  | `--.  ,---' 
\  '_ '`)   `-'`"`|  _|____ . (_ o _)  |         `-'`"`(_ o _).           (_ o _).   |   '-(_{;}_);  \  '_ /  | :|(_ o _) /    |   \    
 > (_)  )   .---. |_( )_   ||  (_,_)___|         .---.  (_,_). '.          (_,_). '. |      (_,_) |  _`,/ \ _/  || (_,_).' __  :_ _:    
(  .  .-'   |   | (_ o._)__|'  \   .---.         |   | .---.  \  :        .---.  \  :| _ _--.   | : (  '\_/ \   ;|  |\ \  |  | (_I_)    
 `-'`-'|___ |   | |(_,_)     \  `-'    /         |   | \    `-'  |        \    `-'  ||( ' ) |   |  \ `"/  \  ) / |  | \ `'   /(_(=)_)   
  |        \|   | |   |       \       /          |   |  \       /          \       / (_{;}_)|   |   '. \_/``".'  |  |  \    /  (_I_)    
  `--------`'---' '---'        `'-..-'           '---'   `-...-'            `-...-'  '(_,_) '---'     '-----'    ''-'   `'-'   '---'    
                                                                                                                                        



    .-''-.   ,---.   .--.      .-./`)       ,-----.        ____     __          .-./`)  ,---------.  
  .'_ _   \  |    \  |  |      \ '_ .')   .'  .-,  '.      \   \   /  /         \ .-.') \          \ 
 / ( ` )   ' |  ,  \ |  |     (_ (_) _)  / ,-.|  \ _ \      \  _. /  '          / `-' \  `--.  ,---' 
. (_ o _)  | |  |\_ \|  |       / .  \  ;  \  '_ /  | :      _( )_ .'            `-'`"`     |   \    
|  (_,_)___| |  _( )_\  |  ___  |-'`|   |  _`,/ \ _/  |  ___(_ o _)'             .---.      :_ _:    
'  \   .---. | (_ o _)  | |   | |   '   : (  '\_/ \   ; |   |(_,_)'              |   |      (_I_)    
 \  `-'    / |  (_,_)\  | |   `-'  /     \ `"/  \  ) /  |   `-'  /               |   |     (_(=)_)   
  \       /  |  |    |  |  \      /       '. \_/``".'    \      /                |   |      (_I_)    
   `'-..-'   '--'    '--'   `-..-'          '-----'       `-..-'                 '---'      '---' 
                                                                                                   
-->
<style>
:root {
  --gradient-start: #b43072;
  --gradient-end: #ee5c39;
}
</style>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --font-monospace: 'JetBrains Mono', monospace;
  --font-size-monospace: 14px;
}
.monospace {
  font-family: var(--font-monospace);
  font-size: var(--font-size-monospace);
}
</style>
<html lang="en" data-color-mode="light" data-light-theme="light" data-dark-theme="dark_tritanopia" data-a11y-animated-images="system" data-a11y-link-underlines="true">
<head>
<meta charset="utf-8">
<link rel="dns-prefetch" href="https://github.githubassets.com">
<link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
<link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
<link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
<link rel="preconnect" href="https://github.githubassets.com" crossorigin>
<link rel="preconnect" href="https://avatars.githubusercontent.com">
<link rel="preload" href="https://github.githubassets.com/assets/mona-sans-d1bf285e9b9b.woff2" as="font" type="font/woff2" crossorigin>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-3e154969b9f9.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-9c5b7a476542.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-4cf0d59ab51a.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-0a1f715ee9fb.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-e41ff91f8baa.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-d3b66f11d613.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/site-ae5a61253375.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/customer-stories-09cf584c51b5.css">
<title>Kelly's portfolio</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Hi there kind stranger!">
<meta property="og:title" content="Welcome to Kelly's website!">
<meta property="og:description" content="Explore Kelly's projects, stories, and more.">
<meta property="og:image" content="assets/linkphoto.png">
<meta property="og:url" content="https://hngocle404.github.io/portfolio/">
<meta property="og:type" content="website">
<link rel="icon" href="assets/icon.png" type="image/png">

</head>
<body class="logged-in env-production page-responsive f4" style="word-wrap: break-word;">
<div data-turbo-body class="logged-in env-production page-responsive f4" style="word-wrap: break-word;">
<div class="position-relative header-wrapper js-header-wrapper ">
<a href="#start-of-content" data-skip-target-assigned="false" class="p-3 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

<span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
<span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-765944243383.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-core-705befca9f47.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-7b7b5264f6c1.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-45c3a19dd792.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-0e630d-04276437489b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js-4896ddd4b7bb.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_catalyst_lib_index_js-node_modules_github_hotkey_dist_index_js-no-d67c7f-bd7d077cdcb1.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_ui-commands_ui-commands_ts-d25fac54a6bc.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/keyboard-shortcuts-dialog-cb3d4f30c9ed.js"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.9fa170e9435ed4b922b9.module.css" />


<!-- HEADER BAR -->
  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
  >
        <main class="font-mktg" >

  <div class="sub-nav-mktg js-toggler-container z-3 customer-stories-subnav js-sticky-state position-sticky width-full sub-nav-mktg-shadow ctas-always-visible">
    <div class="sub-nav-mktg-wrapper d-flex flex-items-center py-3 px-3 px-md-4 px-lg-5">
      <a class="sub-nav-title-link Link--primary no-underline f3-mktg d-inline-block text-bold mr-4" 
        href="https://hngocle404.github.io/portfolio/about.html">
        Kelly Le</a>
      <style>
        .sub-nav-title-link:hover {
          background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }
      </style>
      <button
        type="button"
        class="btn-octicon sub-nav-mktg-toggle d-lg-none p-1 flex-order-1 float-right js-toggler-target mr-n1"
        aria-controls="sub-nav-dropdown"
        aria-label="Page navigation"
        aria-expanded="false"
      >
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-chevron-down on-hidden">
    <path d="M5.22 8.22a.749.749 0 0 0 0 1.06l6.25 6.25a.749.749 0 0 0 1.06 0l6.25-6.25a.749.749 0 1 0-1.06-1.06L12 13.939 6.28 8.22a.749.749 0 0 0-1.06 0Z"></path>
</svg>
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-chevron-up on-visible">
    <path d="M18.78 15.78a.749.749 0 0 1-1.06 0L12 10.061 6.28 15.78a.749.749 0 1 1-1.06-1.06l6.25-6.25a.749.749 0 0 1 1.06 0l6.25 6.25a.749.749 0 0 1 0 1.06Z"></path>
</svg>
      </button>
      <div class="sub-nav-mktg-links flex-auto f4-mktg d-flex flex-column flex-lg-row with-title gap-4" id="sub-nav-dropdown">
        <a class="sub-nav-mktg-link Link--primary no-underline py-1 py-lg-2" href="https://hngocle404.github.io/portfolio/about.html">About</a>
        <a class="sub-nav-mktg-link Link--primary no-underline py-1 py-lg-2 active" href="https://hngocle404.github.io/portfolio/assets/NGOCLE_resume.pdf">Resume</a>
        <a class="sub-nav-mktg-link Link--primary no-underline py-1 py-lg-2" href="https://hngocle404.github.io/portfolio/index.html">Projects</a>
      </div>
      <style>
        .sub-nav-mktg-link {
          color: var(--gradient-start);
          position: relative;
        }
        .sub-nav-mktg-link::after {
          content: '';
          position: absolute;
          width: 100%;
          height: 2px;
          bottom: 0;
          left: 0;
          background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
          visibility: hidden;
          transform: scaleX(0);
          transition: all 0.3s ease-in-out;
        }
        .sub-nav-mktg-link:hover::after {
          visibility: visible;
          transform: scaleX(1);
        }
        .sub-nav-mktg-link:hover {
          background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }
      </style>
        <a href="#footer" class="btn-mktg ml-lg-2 mt-2 mt-lg-0 d-block d-lg-inline-block btn-muted-mktg">
          Contact
        </a>
    </div>
</div>
<!-- ==================================================================================== -->


















<div class="border-bottom">
  <div class="pt-9 pb-4 overflow-hidden px-3">
  <div class="container-xl">
    
    <div class="p-responsive">
      
      <p  class="color-fg-muted f3-mktg text-normal mb-1">
Python    
      </p>
      <h1  class="h3-mktg color-fg-default mb-3 mb-md-6">
       Stock analysis & Value-at-Risk estimation for major US tech companies
      </h1>
    </div>

  </div>
</div></div>

<div class="px-3 pb-8 pt-5">
  <div class="container-xl">
    
    <div class="p-responsive">

      <div class="my-4 my-lg-6">


        


<!-- SUMMARY -->
        <p>
          <strong>Objectives</strong>

          <br>
          1. Exploratory data analysis: Conduct a thorough analysis of real-time financial data to identify patterns and trends.
          <br>
          2. Data visualisation: Utilise visualisation techniques to present stock information effectively, aiding in the interpretation of market dynamics.
          <br>
          3. Predictive modelling: Implement models to forecast stock movements and calculate Value at Risk (VaR).
          <br><br>
          <strong>Scope</strong>
          <br>
          This project focuses on examining 4 prominent technology stocks i.e. Apple Inc. (AAPL), Amazon.com Inc. (AMZN), Alphabet Inc. (GOOG), and Microsoft Corporation (MSFT). The analysis spans a one-year period, from 28th January, 2023, to 28th January, 2024, covering 252 trading days.
          <br><br>
          <strong>Project outline</strong>
          <br>
          The project begins with importing libraries and loading stock data for the aforementioned companies (Section 2). Then in Section 3, we will be conducting some basic analysis of the stock performance, covering closing prices, trading volumes, moving averages, and daily returns. Section 4 - 'Risk Analysis - Value at Risk' - explores historical, parametric, and Monte Carlo approaches to computing a stock's Value at Risk. The project concludes with some potential areas for improvement in future projects.
        </p>
        </div>


<!-- IMAGE -->
<div style="margin-bottom: 30px;">
  <img src="risk_us_stocks_assets/20.png" style="width: 100%; height: 300px; object-fit: cover; object-position: 0 55%; border-radius: 8px;">       
</div>




<!-- body text -->


<h1 style="margin-bottom:30px;">1. Loading data</h1>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
import numpy as np
import pandas as pd
import seaborn as sns
from IPython.display import display
import matplotlib.pyplot as plt
from datetime import datetime 
import yfinance as yf 
from scipy.stats import norm
import warnings
warnings.filterwarnings("ignore")
sns.set_style('white')
%matplotlib inline
</div>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
end_date = datetime.now()
start_date = datetime(end_date.year - 1, end_date.month, end_date.day)
stocks = ['AAPL', 'AMZN', 'GOOG', 'MSFT']
company_colours = {'AAPL': '#7c0000', 'AMZN': '#E19A00', 'GOOG': '#25330F', 'MSFT': '#042D29'}
for stock in stocks: 
  globals()[stock] = yf.download(stock, start=start_date, end=end_date)
display(AAPL.head(2)), display(AMZN.head(2)), display(GOOG.head(2)), display(MSFT.head(2))
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/1.png" style="width: 50%;">       
</div>


<hr style="margin: 50px 0;">





<h1 style="margin-bottom:30px;">2. Basic analysis of stock information</h1>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
plt.figure(figsize = (10.5, 3))

for i, stock_symbol in enumerate(stocks, start = 1):
    df = globals()[stock_symbol]
    sns.lineplot(data = df['Adj Close'], color = company_colours[stock_symbol], label = stock_symbol, linewidth = 1.5)

plt.xlabel('Date')
plt.ylabel('Adjusted closing price')
plt.title('Historical adjusted closing prices');
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/2.png" style="width: 60%;">       
</div>

During the observed period, Microsoft (MSFT) consistently demonstrated higher adjusted closing prices compared to the other stocks, reaching its peak on 2023-11-16 at 376.17. Apple (AAPL) followed suit, achieving a stable adjusted closing price of 182.09 on 2023-11-16. On the other hand, Google (GOOG) and Amazon (AMZN) exhibited similar adjusted closing price trends, converging on 2023-11-16 with Google at 138.70 and Amazon at 3634.05. This parallel movement indicates a comparable performance between Google and Amazon.


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
fig = plt.subplots(nrows = 2, ncols = 2, sharey = True, sharex = True, figsize = (10.5, 4))
plt.suptitle('Historical trading volume')

for i, stock_symbol in enumerate(stocks, start = 1):
    df = globals()[stock_symbol]
    plt.subplot(2, 2, i)
    sns.lineplot(data = df['Volume'], color = company_colours[stock_symbol], label = stock_symbol, linewidth = 1.5)
    print(f'Average trading volume (trailing 12 months) for APPLE: {df['Volume'].mean():.0f} shares.')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Average trading volume (trailing 12 months) for APPLE: 57859731 shares.
Average trading volume (trailing 12 months) for APPLE: 56256391 shares.
Average trading volume (trailing 12 months) for APPLE: 25066624 shares.
Average trading volume (trailing 12 months) for APPLE: 27007968 shares.
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/3.png" style="width: 60%;">       
</div>


In terms of the volume of shares traded during the period from February 2, 2023, to February 1, 2024, Apple and Amazon emerged as standout performers, surpassing Microsoft and Google by almost twice the trading volume.

Moving average (MA) is a widely metric used to effectively diminishes price volatility by filtering out random fluctuations.
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
AAPL['MA 10 days'] = AAPL['Adj Close'].rolling(window = 10).mean()
AAPL['MA 20 days'] = AAPL['Adj Close'].rolling(window = 20).mean()
AAPL['MA 50 days'] = AAPL['Adj Close'].rolling(window = 50).mean()

plt.figure(figsize = (10.5, 3))
sns.lineplot(data = AAPL['MA 10 days'], color = '#7c0000', label = '10-day MA', linewidth = 1.5)
sns.lineplot(data = AAPL['MA 20 days'], color = '#E19A00', label = '20-day MA', linewidth = 1.5)
sns.lineplot(data = AAPL['MA 50 days'], color = '#25330F', label = '50-day MA', linewidth = 1.5)

plt.title('Moving averages for APPLE stock')
plt.xlabel('Date')
plt.ylabel('Adjusted closing price');
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/4.png" style="width: 60%;">       
</div>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
fig, axes = plt.subplots(nrows = 2, ncols = 2, sharex = True, figsize = (10.5, 4))
plt.suptitle('Moving averages (trailing 12 months)')
plt.xlabel('Date')

for i, stock_symbol in enumerate(stocks, start = 1):
    df = globals()[stock_symbol]
    df['MA 10 days'] = df['Adj Close'].rolling(window=10).mean()
    df['MA 20 days'] = df['Adj Close'].rolling(window=20).mean()
    df['MA 50 days'] = df['Adj Close'].rolling(window=50).mean()

    plt.subplot(2, 2, i)
    sns.lineplot(data=df['MA 10 days'], color='#7c0000', label='10-day MA', linewidth=1.5)
    sns.lineplot(data=df['MA 20 days'], color='#E19A00', label='20-day MA', linewidth=1.5)
    sns.lineplot(data=df['MA 50 days'], color='#25330F', label='50-day MA', linewidth=1.5)
    plt.ylabel(f'{stock_symbol} close')
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/5.png" style="width: 60%;">       
</div>
  

Now that we've completed some initial analysis, let's focus on assessing the stock's risk. To achieve this, I'll examine the daily variations in the stock, rather than solely its absolute value. Let's use Apple stocks (AAPL) as an example.
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
AAPL['Daily Return'] = AAPL['Adj Close'].pct_change()

plt.figure(figsize = (10.5, 3))
sns.lineplot(
    data = AAPL['Daily Return'],
    color = company_colours['AAPL'])
plt.title('Daily returns of APPLE stock')
plt.xlabel('Date')
plt.ylabel('Return');
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/6.png" style="width: 60%;">       
</div>

Now let's get an overall look at the average daily return using a histogram. We'll use seaborn to create both a histogram and kde plot on the same figure.
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
plt.figure(figsize = (10.5, 3))
sns.histplot(
    data = AAPL['Daily Return'],
    alpha = 1,
    color = company_colours['AAPL'],
    kde = True)

plt.title('Daily returns of APPLE stock')
plt.xlabel('Return');
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/7.png" style="width: 60%;">       
</div>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
all_close = pd.concat([AAPL['Adj Close'], AMZN['Adj Close'], GOOG['Adj Close'], MSFT['Adj Close']], axis = 1)
all_close.columns = ['AAPL', 'AMZN', 'GOOG', 'MSFT']
display(all_close)
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/85.png" style="width: 40%;">       
</div>

Now, we can assess the correlation by comparing the daily returns of the two stocks.
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
sns.jointplot( data = all_close, x = 'AAPL', y = 'AMZN', alpha = 1, color = '#7c0000', height = 5);
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/9.png" style="width: 40%;">       
</div>
Finally, we could also do a correlation plot, to get actual numerical values for the correlation between the stocks' daily return values.


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
sns.pairplot( data = all_close, plot_kws = {'s': 8}, height = 1.245);</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/10.png" style="width: 40%;">       
</div>

We've done some daily return analysis, let's go ahead and start looking deeper into actual risk analysis.






<hr style="margin: 50px 0;">

<h1 style="margin-bottom:30px;">3. Risk analysis - Value at Risk</h1>

<h2 style="margin-bottom:10px;">
    Historical approach
</h2>
Let's proceed to establish a value at risk parameter for our stocks. We can consider value at risk as the sum of money we might anticipate losing (also known as putting at risk) within a specified confidence interval.
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
all_returns = all_close.copy()
for column in ['AAPL', 'AMZN', 'GOOG', 'MSFT']:
    all_returns[column] = all_returns[column].pct_change()
display(all_returns)
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/11.png" style="width: 40%;">       
</div>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
fig = plt.subplots(nrows = 2, ncols = 2, sharex = True, figsize = (10.5, 4))
plt.xlim(left = -0.1, right = 0.1)
plt.ylabel('Count')

for i, stock_symbol in enumerate(stocks, start = 1):
    plt.subplot(2, 2, i)
    plt.title(f'{stock_symbol} shares')
    sns.histplot(data = all_returns[stock_symbol]
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/12.png" style="width: 60%;">       
</div>



<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
def VaR_historical(company):
    '''
    Input:
        > company: Name of the company
    Output:
        > Historical VaR at 3 conventional confidence levels (90%, 95%, 99%)
        > A histogram of the company's returns with a vertical line at 95% conf. level VaR
    '''
    alpha = [0.1, 0.05, 0.01]
    current_price = all_close[company].sort_index(ascending = False).iloc[0]
    var_historical = []
    print(f'Stock:            {company}')
    print('VaR method:       Historical')
    print(f'Current price:    ${current_price:.2f}')
    print(f'Loss will not exceed:')
    for i in alpha:
        loss = all_returns[company].quantile(i)
        nearest_higher = (
            all_returns.loc[all_returns[company] < loss, company]
            .sort_values(ascending=False)
            .iloc[0])        
        print(f'   *   ${-nearest_higher*current_price:.2f} per share ({(1-i)*100:.0f}% confidence)')
        var_historical.append({
            'Confidence': f'{i*100:.0f}%',
            'Loss%': loss,
            'Nearest higher': nearest_higher
        })
    perc_95 = var_historical[1]['Loss%']   
    plt.figure(figsize = (10.5, 3))
    sns.histplot(data = all_returns[company], color = company_colours[company], alpha = 0.9, kde = True)
    plt.axvline(x = perc_95, color = '#564c4d', linewidth = 1)
    plt.annotate(f'VaR (95% confidence):\n             {perc_95*100:.2f}%',
        xy=(perc_95, 28), weight='bold', color='#232023',
        xytext=(perc_95 - 0.045, 24), fontsize=10,
        arrowprops=dict(arrowstyle="->", color='#808080'))
    plt.xlim(left = -0.1, right = 0.1)
    plt.xlabel(f'{company} Returns')
    plt.title(f'{company} Historical Value at Risk
</div>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_historical('AAPL')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            AAPL
VaR method:       Historical
Current price:    $186.86
Loss will not exceed:
   *   $2.59 per share (90% confidence)
   *   $3.35 per share (95% confidence)
   *   $6.69 per share (99% confidence)
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/13.png" style="width: 60%;">       
</div>



<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_historical('AMZN')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            AMZN
VaR method:       Historical
Current price:    $159.28
Loss will not exceed:
   *   $3.29 per share (90% confidence)
   *   $4.37 per share (95% confidence)
   *   $7.02 per share (99% confidence)
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/14.png" style="width: 60%;">       
</div>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_historical('MSFT')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            MSFT
VaR method:       Historical
Current price:    $403.78
Loss will not exceed:
   *   $6.69 per share (90% confidence)
   *   $9.15 per share (95% confidence)
   *   $12.46 per share (99% confidence)
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/15.png" style="width: 60%;">       
</div>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_historical('GOOG')
</div>

<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            GOOG
VaR method:       Historical
Current price:    $142.71
Loss will not exceed:
   *   $2.59 per share (90% confidence)
   *   $3.78 per share (95% confidence)
   *   $10.49 per share (99% confidence)
</div>
<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/16.png" style="width: 60%;">       
</div>




<h2 style="margin-bottom:10px;">
    Parametric approach
</h2>
<p>
The parametric Value at Risk (VaR) method, particularly the Variance-Covariance approach, estimates the potential loss in a financial portfolio by assuming that returns follow a normal distribution. This method calculates VaR based on the standard deviation and correlation of asset returns.
</p><p>
Its advantages include computational efficiency, requiring only correlation and volatility matrices, and suitability for linear assets. However, drawbacks arise due to its assumption of normality, making it less accurate for non-linear derivatives, options, and assets with skewed distributions. Additionally, the method's accuracy diminishes over longer time horizons, limiting its applicability. Despite these limitations, the simplicity and speed of the parametric approach make it a useful tool, especially for portfolios with straightforward risk exposures.
</p>
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
def VaR_parametric(company): 
    '''
    Input:
        > company: Name of the company
    Output:
        > Parametric VaR at 3 conventional confidence levels (90%, 95%, 99%)
        > A histogram of the company's returns with a vertical line at 95% conf. level VaR
    '''
    alpha = [0.1, 0.05, 0.01]
    current_price = all_close[company].sort_index(ascending = False).iloc[0]
    var_parametric = []  
    print(f'Stock:            {company}')
    print('VaR method:       Parametric') 
    print(f'Current price:    ${current_price:.2f}')
    print(f'Loss will not exceed:')
    for i in alpha:
        mean = np.mean(all_returns[company])
        stdev = np.std(all_returns[company], axis = 0)
        z_score = norm.ppf(1 - i)
        var = -z_score * stdev
        print(f'   *   ${-var * current_price:.2f} per share ({(1-i)*100:.0f}% confidence)')
        var_parametric.append({
            'Confidence': f'{(1 - i) * 100:.0f}%',
            'Loss%': var
        })
</div>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_parametric('AAPL')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            AAPL
VaR method:       Parametric
Current price:    $186.86
Loss will not exceed:
   *   $2.99 per share (90% confidence)
   *   $3.84 per share (95% confidence)
   *   $5.43 per share (99% confidence)
</div>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_parametric('AMZN')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            AMZN
VaR method:       Parametric
Current price:    $159.28
Loss will not exceed:
   *   $3.98 per share (90% confidence)
   *   $5.11 per share (95% confidence)
   *   $7.22 per share (99% confidence)
</div>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_parametric('MSFT')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            MSFT
VaR method:       Parametric
Current price:    $403.78
Loss will not exceed:
   *   $7.63 per share (90% confidence)
   *   $9.79 per share (95% confidence)
   *   $13.84 per share (99% confidence)
</div>



<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_parametric('GOOG')
</div>
<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            GOOG
VaR method:       Parametric
Current price:    $142.71
Loss will not exceed:
   *   $3.39 per share (90% confidence)
   *   $4.36 per share (95% confidence)
   *   $6.16 per share (99% confidence)
</div>



<h2 style="margin-bottom:10px;">
Monte Carlo simulation approach
</h2>
<p>
The Monte Carlo simulation approach estimates Value at Risk (VaR) by simulating future stock prices through a loop that generates random shocks and calculates drift for each day based on historical returns. This method, distinct from Historical Simulation, uses a lognormal distribution to generate risk factor scenarios. It accurately prices both linear and non-linear positions, providing a full distribution of potential portfolio gains and losses.

</p><p>
This approach offers flexibility in specifying parameters, effectively capturing non-normalities, and accommodating diverse complex positions. However, it relies on assuming a lognormal distribution, necessitates appropriate scenario generation, and demands substantial computational resources.
</p>

</p><p>
<ul style="list-style-position: inside; padding-left: 20px;">
  <li>A random shock is generated using a normal distribution. This represents the unpredictable component of stock price movements.</li>
  <li>A drift is calculated based on the mean of daily returns. The drift represents the average expected movement in the stock price.</li>
  <li>The new stock price for the day is calculated using the previous day's price, drift, and shock.</li>
</ul></p>


<p>
  In essence, this function employs both a predictable component (drift) and an unpredictable component (shock) to project future stock prices over a specified timeframe, generating a trajectory based on the given parameters.

</p>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
def price_montecarlo(company, days): 
    '''
    Input:
        > company: Name of the company
        > days: Number of days for the simulation

    Output:
        > A DataFrame showing simulated stock prices
    '''
    initial_price = all_close[company].sort_index(ascending = True).iloc[0]
    results = pd.DataFrame(columns=['Time', 'Simulated price', 'Drift', 'Shock'])
    results.loc[0] = [0, initial_price, 0, 0]

    mean = np.mean(all_returns[company])
    stdev = np.std(all_returns[company], axis = 0)
    delta_t = 1 / days

    for i in range(1, days):
        results.loc[i, 'Time'] = i
        results.loc[i, 'Drift'] = mean * delta_t
        results.loc[i, 'Shock'] = np.random.normal(mean * delta_t, stdev * np.sqrt(delta_t))
        results.loc[i, 'Simulated price'] = (
        results['Simulated price'].iloc[i - 1] +
            (results['Simulated price'].iloc[i - 1] *
            (results['Drift'].iloc[i] + results['Shock'].iloc[i])))

    return results</div>
<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
price_montecarlo('AMZN', 252)</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/17.png" style="width: 40%;">       
</div>


<p>
Next, we will be:
</p><p>
<ul style="list-style-position: inside; padding-left: 20px;">
  <li>Running the Monte Carlo simulation function for a larger number of repetitions (e.g. 20 times).
</li>
  <li>Simulating the future stock prices for each run of the Monte Carlo simulation and storing the final stock price from each simulation.</li>
  <li>
After completing all simulations, calculate the 1% / 5% / 10% quantile. This quantile represents a value below which 1% / 5% / 10% of the simulated stock prices fall.</li>
</ul></p>

<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
company = 'AAPL'
days = 252
rep = 100

plt.figure(figsize = (10.5, 3))
for r in range(rep):
    sns.lineplot(
        data = price_montecarlo(company, days),
        y = 'Simulated price',
        x = 'Time'
    )
plt.xlabel("Days")
plt.ylabel("Price")
plt.title(f'Monte Carlo simulation for {company} stock price, {rep} repetitions');</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/18.png" style="width: 60%;">       
</div>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
def VaR_montecarlo(company, days, rep):
    '''
    Input:
        > company: Name of the company
        > days: Number of days for the simulation
        > rep: Number of repetitions for the Monte Carlo simulation
    Output:
        > Monte Carlo VaR at 3 conventional confidence levels (90%, 95%, 99%)
        > A histogram of the company's simulated losses over repetitions
    '''
    sim_results = []
    current_price = all_close['AAPL'].sort_index(ascending = False).iloc[0]
    initial_price = all_close['AAPL'].sort_index(ascending = True).iloc[0]

    for i in range(1, rep+1):
        prediction = price_montecarlo('AAPL', days).iloc[-1]['Simulated price']
        sim_results.append({
            'Simulation': i,
            'Prediction': prediction,
            'Loss': current_price - prediction
        })
        sim_results_df = pd.DataFrame(sim_results)

    alpha = [0.1, 0.05, 0.01]
    print(f'Stock:            {company}')
    print('VaR method:       Monte Carlo') 
    print(f'Current price:    ${current_price:.2f}')
    print(f'Loss will not exceed:')
    for i in alpha:
        cutoff = sim_results_df['Prediction'].quantile(i)
        var = current_price - cutoff
        print(f'   *   ${var:.2f} per share ({(1-i)*100:.0f}% confidence)')

    plt.figure(figsize = (10.5, 3))
    sns.histplot(
        data = sim_results_df,
        x = 'Loss',
        color = company_colours[company],
        alpha = 1,
        kde = True
    )
    plt.title(f'Monte Carlo simulation for {company} stock VaR, {rep} repetitions');</div>


<div class="color-bg-subtle" style="border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
VaR_montecarlo('AAPL', 252, 2000)
</div>

<div class="color-bg-default" style="border: 1px solid #d1d5da; border-radius: 5px; padding: 0px 22px 22px 25px; margin-top: 20px; margin-bottom: 20px; white-space: pre-wrap; font-family: var(--font-monospace); font-size: var(--font-size-monospace);">
Stock:            AAPL
VaR method:       Monte Carlo
Current price:    $186.86
Loss will not exceed:
   *   $38.94 per share (90% confidence)
   *   $39.64 per share (95% confidence)
   *   $40.71 per share (99% confidence)
</div>

<div style="text-align: center; margin: 1%;">
  <img src="risk_us_stocks_assets/19.png" style="width: 60%;">       
</div>
<hr style="margin: 50px 0;">

<h1 style="margin-bottom:30px;">4. Recommendations for future work</h1>

<p>1. <strong>Weighted Moving Average Methods for VaR computation</strong></p>
<p>Unlike the VaR methods used in this project, which assume uniform weights for all historical returns, weighted approaches such as the Exponential Weighted Moving Average Method (EWMA) assigns non-uniform weights, with a preference for more recent returns. The most recent returns have higher weights because they influence "today's" return more heavily than returns further in the past. This method proves advantageous in capturing varying influences of past returns on the current risk assessment.</p>


<p>2. <strong>Include VaR backtesting</strong></p>
<p>Various forms of backtesting could be used to assess and enhance the reliability of VaR models. One suggested approach is the Kupiec's proportion-of-failures (POF) test, which is a simple and straihtforward statistical method that evaluates the accuracy of VaR predictions.</p>





 </main>

 




    



 




 

  
  

  
  


<!-- FOOTER -->
<footer id="footer" role="contentinfo" class="footer pt-6 position-relative color-bg-subtle "><h2 class="sr-only">Site-wide Links</h2>
  <div class="container-xl p-responsive"><div class="d-flex flex-wrap py-5 mb-5"><section class="col-12 col-lg-4 mb-5"><img src="assets/namelogo.png" width="140" height="140">
    <h3 class="h5 mt-2 mb-0">What's green, has 4 legs. and could <br>kill you if it fell out of a tree?</h3>
    <p class="f5 color-fg-muted mb-3">A pool table.</p><a class="btn-mktg mb-4 btn-muted-mktg" href="#" style="scroll-behavior: smooth;">Back to top</a></section>

    <nav class="col-14 col-sm-8 col-lg-4 mb-6 mb-md-2 pr-3 pr-lg-0 pl-lg-4" aria-labelledby="footer-title-product">
      <h3 class="h5 mb-3 text-mono color-fg-muted text-normal" id="footer-title-product">
        Contact
      </h3>
      <ul class="list-style-none color-fg-muted f5">
        <li class="lh-condensed mb-3">
          <a class="Link--secondary" href="https://zalo.me/0778882602">
          Zalo: (+84) 77 888 2602
        </a></li>
        
        <li class="lh-condensed mb-3">
          <a class="Link--secondary" href="mailto:hngoc.le.404@gmail.com">
            Email: hngoc.le.404@gmail.com
          </a></li>

          <li class="lh-condensed mb-3">
            <a class="Link--secondary" href="https://www.linkedin.com/in/hnl404/">
              Linkedin: HN Le
            </a></li>
          
        <li class="lh-condensed mb-3">
          <a class="Link--secondary" href="https://discord.com/users/1190260937719033916">
            Discord: kalulu404
          </a></li>
                    
          </ul></nav>
            <nav class="col-14 col-sm-10 col-lg-4 mb-6 mb-md-2 pr-5 pr-md-0 pl-md-4" aria-labelledby="footer-title-platform">
              <h3 class="h5 mb-3 text-mono color-fg-muted text-normal" id="footer-title-platform">
                Resources
              </h3>
              <ul class="list-style-none f5"><li class="lh-condensed mb-3">
                <a class="Link--secondary" href="https://www.myequals.net/r/sharelink/550d70d0-6ddc-4eba-8afc-618cabcd697d/ba1fa78f-59b1-4322-8156-6804761b4621">
                  Testamur
                </a></li>
                <li class="lh-condensed mb-3"><a class="Link--secondary" href="https://hngocle404.github.io/portfolio/assets/NGOCLE_resume.pdf">Resume</a></li></ul></nav></div></div>
              </footer></div><div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true" ></div>
              <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div></body></html>
